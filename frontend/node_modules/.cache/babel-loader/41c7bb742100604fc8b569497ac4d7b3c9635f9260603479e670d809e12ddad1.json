{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState, useCallback } from 'react';\nconst INACTIVITY_THRESHOLD = 5000;\nexport const useFocusTimer = () => {\n  _s();\n  const [state, setState] = useState({\n    totalTime: 0,\n    activeTime: 0,\n    focusScore: 0,\n    isActive: true\n  });\n  const timerRef = useRef();\n  const lastActivityRef = useRef(Date.now());\n  const isVisibleRef = useRef(true);\n  const updateFocusScore = useCallback((active, total) => {\n    const score = total > 0 ? Math.round(active / total * 100) : 0;\n    setState(prev => ({\n      ...prev,\n      focusScore: Math.min(score, 100)\n    }));\n  }, []);\n  useEffect(() => {\n    const handleActivity = () => {\n      lastActivityRef.current = Date.now();\n      setState(prev => ({\n        ...prev,\n        isActive: true\n      }));\n    };\n    const handleVisibilityChange = () => {\n      isVisibleRef.current = !document.hidden;\n      if (!document.hidden) {\n        lastActivityRef.current = Date.now();\n      }\n    };\n    document.addEventListener('mousemove', handleActivity);\n    document.addEventListener('keydown', handleActivity);\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    timerRef.current = setInterval(() => {\n      setState(prev => {\n        const newTotal = prev.totalTime + 1;\n        const timeSinceActivity = Date.now() - lastActivityRef.current;\n        const isCurrentlyActive = isVisibleRef.current && timeSinceActivity < INACTIVITY_THRESHOLD;\n        const newActive = isCurrentlyActive ? prev.activeTime + 1 : prev.activeTime;\n        updateFocusScore(newActive, newTotal);\n        return {\n          ...prev,\n          totalTime: newTotal,\n          activeTime: newActive,\n          isActive: isCurrentlyActive\n        };\n      });\n    }, 1000);\n    return () => {\n      document.removeEventListener('mousemove', handleActivity);\n      document.removeEventListener('keydown', handleActivity);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [updateFocusScore]);\n  const reset = useCallback(() => {\n    setState({\n      totalTime: 0,\n      activeTime: 0,\n      focusScore: 0,\n      isActive: true\n    });\n    lastActivityRef.current = Date.now();\n  }, []);\n  return {\n    ...state,\n    reset\n  };\n};\n_s(useFocusTimer, \"u8TK7lKEhOtYYJRsLIeK+4HNQeU=\");","map":{"version":3,"names":["useEffect","useRef","useState","useCallback","INACTIVITY_THRESHOLD","useFocusTimer","_s","state","setState","totalTime","activeTime","focusScore","isActive","timerRef","lastActivityRef","Date","now","isVisibleRef","updateFocusScore","active","total","score","Math","round","prev","min","handleActivity","current","handleVisibilityChange","document","hidden","addEventListener","setInterval","newTotal","timeSinceActivity","isCurrentlyActive","newActive","removeEventListener","clearInterval","reset"],"sources":["C:/Users/kuben/OneDrive/Desktop/PERSONALIZED LEARNING COPILOT FOR CORE COURSES/frontend/src/useFocusTimer.ts"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from 'react';\n\ninterface FocusTimerState {\n  totalTime: number;\n  activeTime: number;\n  focusScore: number;\n  isActive: boolean;\n}\n\nconst INACTIVITY_THRESHOLD = 5000;\n\nexport const useFocusTimer = () => {\n  const [state, setState] = useState<FocusTimerState>({\n    totalTime: 0,\n    activeTime: 0,\n    focusScore: 0,\n    isActive: true,\n  });\n\n  const timerRef = useRef<NodeJS.Timeout>();\n  const lastActivityRef = useRef<number>(Date.now());\n  const isVisibleRef = useRef<boolean>(true);\n\n  const updateFocusScore = useCallback((active: number, total: number) => {\n    const score = total > 0 ? Math.round((active / total) * 100) : 0;\n    setState(prev => ({ ...prev, focusScore: Math.min(score, 100) }));\n  }, []);\n\n  useEffect(() => {\n    const handleActivity = () => {\n      lastActivityRef.current = Date.now();\n      setState(prev => ({ ...prev, isActive: true }));\n    };\n\n    const handleVisibilityChange = () => {\n      isVisibleRef.current = !document.hidden;\n      if (!document.hidden) {\n        lastActivityRef.current = Date.now();\n      }\n    };\n\n    document.addEventListener('mousemove', handleActivity);\n    document.addEventListener('keydown', handleActivity);\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    timerRef.current = setInterval(() => {\n      setState(prev => {\n        const newTotal = prev.totalTime + 1;\n        const timeSinceActivity = Date.now() - lastActivityRef.current;\n        const isCurrentlyActive = isVisibleRef.current && timeSinceActivity < INACTIVITY_THRESHOLD;\n        const newActive = isCurrentlyActive ? prev.activeTime + 1 : prev.activeTime;\n\n        updateFocusScore(newActive, newTotal);\n\n        return {\n          ...prev,\n          totalTime: newTotal,\n          activeTime: newActive,\n          isActive: isCurrentlyActive,\n        };\n      });\n    }, 1000);\n\n    return () => {\n      document.removeEventListener('mousemove', handleActivity);\n      document.removeEventListener('keydown', handleActivity);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [updateFocusScore]);\n\n  const reset = useCallback(() => {\n    setState({ totalTime: 0, activeTime: 0, focusScore: 0, isActive: true });\n    lastActivityRef.current = Date.now();\n  }, []);\n\n  return { ...state, reset };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}