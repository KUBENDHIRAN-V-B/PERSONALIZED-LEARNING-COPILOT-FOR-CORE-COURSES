{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{FiWifi,FiWifiOff,FiChevronDown,FiChevronUp,FiRefreshCw}from'react-icons/fi';import{statusAPI}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const APIStatusIndicator=()=>{const[status,setStatus]=useState(null);const[expanded,setExpanded]=useState(false);const[loading,setLoading]=useState(false);const[lastUpdate,setLastUpdate]=useState(null);const fetchStatus=useCallback(async()=>{setLoading(true);try{const response=await statusAPI.getStatus();setStatus(response.data);setLastUpdate(new Date());}catch(error){console.error('Failed to fetch API status:',error);}finally{setLoading(false);}},[]);useEffect(()=>{fetchStatus();// Refresh every 30 seconds\nconst interval=setInterval(fetchStatus,30000);return()=>clearInterval(interval);},[fetchStatus]);const getConnectedCount=()=>{if(!status)return 0;return Object.values(status.apis).filter(api=>api.connected).length;};const getStatusColor=api=>{if(api.connected)return'bg-green-500';if(api.code===429)return'bg-yellow-500';return'bg-red-500';};const getStatusText=api=>{if(api.connected)return'Connected';if(api.code===429)return'Rate Limited';if(api.code===401)return'Invalid Key';return'Offline';};const totalAPIs=status?Object.keys(status.apis).length:4;const connectedAPIs=getConnectedCount();return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setExpanded(!expanded),className:\"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded-lg \".concat(connectedAPIs>0?'bg-green-100':'bg-red-100'),children:connectedAPIs>0?/*#__PURE__*/_jsx(FiWifi,{className:\"text-green-600\",size:18}):/*#__PURE__*/_jsx(FiWifiOff,{className:\"text-red-600\",size:18})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:\"AI Services Status\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[connectedAPIs,\"/\",totalAPIs,\" APIs connected\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-1\",children:status&&Object.values(status.apis).map((api,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full \".concat(getStatusColor(api)),title:\"\".concat(api.name,\": \").concat(getStatusText(api))},idx))}),expanded?/*#__PURE__*/_jsx(FiChevronUp,{size:18}):/*#__PURE__*/_jsx(FiChevronDown,{size:18})]})]}),expanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-100 px-4 py-3 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500\",children:[\"Last updated: \",(lastUpdate===null||lastUpdate===void 0?void 0:lastUpdate.toLocaleTimeString())||'Never']}),/*#__PURE__*/_jsxs(\"button\",{onClick:fetchStatus,disabled:loading,className:\"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 disabled:opacity-50\",children:[/*#__PURE__*/_jsx(FiRefreshCw,{className:loading?'animate-spin':'',size:12}),\"Refresh\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:status&&Object.entries(status.apis).map(_ref=>{let[key,api]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-2 bg-white rounded-lg border border-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2.5 h-2.5 rounded-full \".concat(getStatusColor(api))}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-800\",children:api.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 text-xs\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 rounded-full \".concat(api.connected?'bg-green-100 text-green-700':api.code===429?'bg-yellow-100 text-yellow-700':'bg-red-100 text-red-700'),children:getStatusText(api)}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",title:\"Daily limit\",children:api.limit}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",title:\"Requests per minute\",children:api.rpm})]})]},key);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 pt-3 border-t border-gray-200 flex justify-center gap-4 text-xs text-gray-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-green-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Connected\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-yellow-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Rate Limited\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-red-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Offline\"})]})]})]})]});};export default APIStatusIndicator;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}